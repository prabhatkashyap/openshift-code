#s is a simple script and will be executed on your CI system if
# available.  Otherwise it will execute while your application is stopped
# before the build step.  This script gets executed directly, so it
# could be python, php, ruby, etc.
set -x
export GRAILS_HOME=$OPENSHIFT_DATA_DIR/grails-3.1.14
export PATH=$GRAILS_HOME/bin:$PATH

export GRADLE_USER_HOME=$OPENSHIFT_DATA_DIR/gradle
export GRADLE_HOME=$OPENSHIFT_DATA_DIR/gradle-2.13
export PATH=$GRADLE_HOME/bin:$PATH

cd $OPENSHIFT_REPO_DIR
export GRAILS_OPTS="-Xmx512m -Xms256m -XX:MaxPermSize=256m"
gradle build
grails -Dgrails.work.dir=$OPENSHIFT_DATA_DIR.grails prod war

rm -rf $OPENSHIFT_DATA_DIR/grails-3.1.14
rm -rf $OPENSHIFT_DATA_DIR/gradle-2.13
